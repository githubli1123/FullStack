<!--
 * @Author: ZJ Wu
 * @Date: 2024-01-19 16:19:16
 * @LastEditTime: 2024-01-19 16:42:27
 * @Description: 
-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      .myDiv {
        width: 100px;
        height: 100px;
        margin: 50px;
        background-color: blue;
        position: relative;
        animation: my-animation 5s linear infinite;
      }
      @keyframes my-animation {
        from {
          left: 0%;
          rotate: 0deg;
        }
        to {
          left: 100%;
          rotate: 360deg;
        }
      }
    </style>
  </head>
  <body>
    <div class="myDiv"></div>
    <button onclick="runTask(longTask)">requestAnimationFrame</button>
    
    <script>
      // 模拟耗时操作，大概10ms
      function myFunc() {
        const startTime = Date.now();
        while (Date.now() - startTime < 10) {}
      }

      // 模拟耗时任务
      function longTask(){
        for (let i = 0; i < 300; i++) {
          myFunc();
        }
      }


      function runTask(task){
        return new Promise((resolve) => {
                requestAnimationFrame(() => {
                    task();
                    resolve(true); // 任务执行完成，返回true
                })
            });
      }
    </script>
  </body>
</html>

